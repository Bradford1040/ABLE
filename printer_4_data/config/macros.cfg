[gcode_macro _CLIENT_VARIABLE]
gcode:
  variable_use_custom_pos   : True ; use custom park coordinates for x,y [True/False]
  variable_custom_park_x    : 355.0   ; custom x position; value must be within your defined min and max of X
  variable_custom_park_y    : 355.0   ; custom y position; value must be within your defined min and max of Y
  variable_custom_park_dz   : 10.0   ; custom dz value; the value in mm to lift the nozzle when move to park position
  variable_retract          : 2.0   ; the value to retract while PAUSE
  variable_cancel_retract   : 2.0   ; the value to retract while CANCEL_PRINT
  variable_speed_retract    : 65.0  ; retract speed in mm/s
  variable_unretract        : 1.0   ; the value to unretract while RESUME
  variable_speed_unretract  : 45.0  ; unretract speed in mm/s
  variable_speed_hop        : 15.0  ; z move speed in mm/s
  variable_speed_move       : 100.0 ; move speed in mm/s
  variable_park_at_cancel   : True ; allow to move the toolhead to park while execute CANCEL_PRINT [True/False]
  variable_park_at_cancel_x : True  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
  variable_park_at_cancel_y : True  ; different park position during CANCEL_PRINT [None/Position as Float]; park_at_cancel must be True
  ## !!! Caution [firmware_retraction] must be defined in the printer.cfg if you set use_fw_retract: True !!!
  variable_use_fw_retract   : True ; use fw_retraction instead of the manual version [True/False]
  variable_idle_timeout     : 7200     ; time in sec until idle_timeout kicks in. Value 0 means that no value will be set or restored
  #variable_runout_sensor    : ""    ; If a sensor is defined, it will be used to cancel the execution of RESUME in case no filament is detected.
  ##                                   Specify the config name of the runout sensor e.g "filament_switch_sensor runout". Hint use the same as in your printer.cfg
  ## !!! Custom macros, please use with care and review the section of the corresponding macro.
  ## These macros are for simple operations like setting a status LED. Please make sure your macro does not interfere with the basic macro functions.
  ## Only  single line commands are supported, please create a macro if you need more than one command.
  #variable_user_pause_macro : ""    ; Everything inside the "" will be executed after the klipper base pause (PAUSE_BASE) function
  #variable_user_resume_macro: ""    ; Everything inside the "" will be executed before the klipper base resume (RESUME_BASE) function
  #variable_user_cancel_macro: ""    ; Everything inside the "" will be executed before the klipper base cancel (CANCEL_PRINT_BASE) function
#gcode:

[gcode_macro PERCISE_HOME]
gcode:
  M117 Homing
  G90
  G28 Y0
  G1 Y5 F1200
  G4 P2000
  G28 X0
  G1 Y5 F1200
  G4 P2000
  G28 Z0
  M117 Homed
  BED_MESH_PROFILE LOAD=default

[gcode_macro BED_TRAMMING]
gcode:
    M190 S75
   # M109 S190
    PERCISE_HOME
    G4 P2000
    SCREWS_TILT_CALCULATE

[gcode_macro MANUAL_BED_TRAMMING]
gcode:
    M190 S75
    M109 S190
    PERCISE_HOME
    G4 P2000
    BED_SCREWS_ADJUST

[gcode_macro Calibrate_Home]
gcode:
  #SET_GCODE_OFFSET Z=4
  G4 P4000
  M190 S75
  M109 S190
  PERCISE_HOME
  G4 P1000
  PROBE_CALIBRATE

#[gcode_macro END_PRINT]
#gcode:
  #_TOOLHEAD_PARK_PAUSE_CANCEL
  #TURN_OFF_HEATERS
  #M84
  #G91 ; Relative positioning
  #G1 E-2 Z10 F2700 ; Retract and lift Z
  #G90 ; Absolute positioning
  #G1 X355 Y355 F9000 ; end print X Y axis
  #M104 S0 ; turn off temperature
  #M140 S0 ; turn off heatbed
  #M107 ; turn off fans
  #M84 X Y E ; turn off steppers X Y E, leave Z enabled
  #M221 S100  # Reset flow to 100%
  #M220 S100 # Reset Feedrate to 100%

[gcode_macro END_PRINT]
gcode: 
  G91 ; Relative positioning
  G1 E-2 Z10 F2700 ; Retract and lift Z
  G90 ; Absolute positioning
  G1 X355 Y355 F9000 ; end print X Y axis
  M104 S0 ; turn off temperature
  M140 S0 ; turn off heatbed
  M107 ; turn off fans
  M84  ; turn off steppers
  M221 S100  # Reset flow to 100%
  M220 S100 # Reset Feedrate to 100%
  M117 Print Complete

[gcode_macro backup_git]
gcode:
    RUN_SHELL_COMMAND CMD=update_git_script